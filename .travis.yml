os: osx
osx_image: xcode10.1

before_script:
  - brew update >/dev/null
  - brew tap osx-cross/avr
  - cd $(brew --repo)/Library/Taps/osx-cross/homebrew-avr
  - git checkout --detach
  - git fetch origin '+refs/heads/*:refs/heads/*'
  - git checkout $TRAVIS_BRANCH

script:
  - brew audit avr-gdb.rb avr-binutils.rb avr-gcc.rb
  - brew audit avr-gcc@4.rb avr-gcc@5.rb avr-gcc@6.rb avr-gcc@7.rb
  - brew audit avarice.rb simavr.rb

  - travis_wait 240 brew install avr-gdb.rb avr-binutils.rb avr-gcc.rb
  - travis_wait 240 brew install avr-gcc@4.rb avr-gcc@5.rb avr-gcc@6.rb avr-gcc@7.rb
  - travis_wait 240 brew install --HEAD avarice.rb
  - travis_wait 240 brew install --HEAD simavr.rb

  - brew test avr-gdb.rb avr-binutils.rb avr-gcc.rb
  - brew test avr-gcc@4.rb avr-gcc@5.rb avr-gcc@6.rb avr-gcc@7.rb
  - brew test avarice.rb simavr.rb